<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Boutique Buendía</title>

<style>
body{margin:0;font-family:Inter,system-ui,sans-serif;background:#fff;color:#111;}
header{background:#fff;border-bottom:1px solid #ddd;position:sticky;top:0;z-index:40;display:flex;align-items:center;justify-content:space-between;padding:12px 20px;}
.logo{font-size:22px;font-weight:900;}
.products-grid{max-width:1100px;margin:auto;padding:25px;display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:25px;}
.card{background:#fff;border-radius:12px;padding:10px;box-shadow:0 4px 12px rgba(0,0,0,0.12);text-align:center;cursor:pointer;}
.card img{width:100%;height:200px;object-fit:cover;background:#f2f2f2;border-radius:10px;}
.card .name{font-weight:600;margin-top:8px;}
.card .price{font-weight:900;margin-top:4px;}
#cartBtn img{width:25px;cursor:pointer;}

.cart-panel{position:fixed;top:0;right:-400px;width:340px;height:100%;background:#fff;box-shadow:-4px 0 20px rgba(0,0,0,0.3);transition:.3s;padding:18px;z-index:100;}
.cart-panel.open{right:0;}
.cart-item{display:flex;justify-content:space-between;margin-bottom:12px;font-size:14px;}
.cart-item button{background:none;border:none;color:#7c4dff;font-weight:bold;cursor:pointer;}

#loginBtn{background:none;border:none;color:#7c4dff;font-weight:600;font-size:16px;cursor:pointer;}
</style>
</head>

<body>

<header>
  <button id="loginBtn">Iniciar sesión</button>
  <div class="logo">Boutique Buendía</div>
  <div id="cartBtn"><img src="https://cdn-icons-png.flaticon.com/512/833/833314.png"></div>
</header>

<main>
  <div class="products-grid" id="grid"></div>
</main>

<!-- Carrito -->
<div class="cart-panel" id="cartPanel">
  <h2>Carrito</h2>
  <div id="cartItems"></div>
  <p id="cartTotal" style="text-align:right;font-weight:bold;"></p>
</div>

<!-- LOGIN / REGISTRO -->
<div id="loginPanel" style="position:fixed;top:0;left:0;width:100%;height:100%;
background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:300;">
  <div style="background:#fff;padding:25px;border-radius:12px;width:300px;text-align:center;">
    
    <h2 id="loginTitle">Iniciar Sesión</h2>

    <input id="userInput" type="text" placeholder="Usuario" style="width:100%;padding:8px;margin-top:10px;">
    <input id="passInput" type="password" placeholder="Contraseña" style="width:100%;padding:8px;margin-top:10px;">

    <button id="loginAction" style="margin-top:15px;width:100%;padding:8px;background:#7c4dff;color:#fff;border:none;border-radius:8px;">Entrar</button>

    <p style="margin-top:14px;font-size:14px;">
      ¿No tienes cuenta? <span onclick="mostrarRegistro()" style="color:#7c4dff;cursor:pointer;">Regístrate</span>
    </p>
  </div>
</div>

<script>
// ================= PRODUCTOS ==================
let productos = JSON.parse(localStorage.getItem("productos")) || [];
let cart = JSON.parse(localStorage.getItem("cart")) || [];

function renderProductos(){
  const grid = document.getElementById("grid");
  grid.innerHTML = "";
  productos.forEach(p=>{
    grid.innerHTML += `
      <div class="card" onclick="window.location='product.html?id=${p.id}'">
        <img src="${p.imagen}">
        <div class="name">${p.nombre}</div>
        <div class="price">$${p.precio}</div>
      </div>
    `;
  });
}
renderProductos();

// ================= CARRITO ==================
function renderCart(){
  const c=document.getElementById("cartItems");
  c.innerHTML="";
  let total=0;
  cart.forEach((p,i)=>{total+=p.pr;
    c.innerHTML+=`<div class="cart-item">${p.n} - $${p.pr}<button onclick="removeItem(${i})">✕</button></div>`;
  });
  document.getElementById("cartTotal").textContent="Total: $" + total;
}
function removeItem(i){
  cart.splice(i,1);
  localStorage.setItem("cart",JSON.stringify(cart));
  renderCart();
}
document.getElementById("cartBtn").onclick=()=>document.getElementById("cartPanel").classList.add("open");
document.getElementById("cartPanel").onclick=()=>document.getElementById("cartPanel").classList.remove("open");
renderCart();

// ================= LOGIN ==================
document.getElementById("loginBtn").onclick=()=>document.getElementById("loginPanel").style.display="flex";

function iniciarSesion(){
  let user=userInput.value.trim();
  let pass=passInput.value.trim();

  if(user==="admin" && pass==="admin123"){
    localStorage.setItem("usuario",JSON.stringify({nombre:"Admin",tipo:"admin"}));
    location.reload();
    return;
  }

  let usuarios=JSON.parse(localStorage.getItem("usuarios"))||[];
  let encontrado=usuarios.find(u=>u.nombre===user && u.pass===pass);

  if(encontrado){
    localStorage.setItem("usuario",JSON.stringify({nombre:encontrado.nombre,tipo:"cliente"}));
    location.reload();
  } else alert("Datos incorrectos");
}
document.getElementById("loginAction").onclick=iniciarSesion;

function mostrarRegistro(){
  document.getElementById("loginTitle").innerText="Crear Cuenta";
  document.getElementById("loginAction").innerText="Registrarme";
  document.getElementById("loginAction").onclick=registrarse;
}

function registrarse(){
  let user=userInput.value.trim();
  let pass=passInput.value.trim();
  if(!user||!pass)return alert("Completa todo");

  let usuarios=JSON.parse(localStorage.getItem("usuarios"))||[];
  usuarios.push({nombre:user,pass:pass});
  localStorage.setItem("usuarios",JSON.stringify(usuarios));
  alert("Cuenta creada ✅ Ahora inicia sesión");
  location.reload();
}
</script>

<!-- ✅ HEADER GLOBAL -->
<script src="js/header.js"></script>

</body>
</html>
