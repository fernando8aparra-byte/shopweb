<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Producto - Boutique Buend√≠a</title>

<style>
body{font-family:Inter,system-ui,sans-serif;margin:0;background:#fff;color:#111;}
header{background:#fff;border-bottom:1px solid #ddd;position:sticky;top:0;z-index:50;display:flex;justify-content:space-between;align-items:center;padding:12px 20px;}
.logo{font-size:22px;font-weight:900;}
main{max-width:1100px;margin:auto;padding:20px;}
.product-container{display:flex;flex-wrap:wrap;gap:30px;margin-top:20px;}
.product-container img{width:350px;border-radius:12px;object-fit:contain;background:#f2f2f2;padding:10px;}
.product-info{flex:1;min-width:280px;}
.product-info h1{font-size:30px;margin-bottom:10px;}
.product-info .price{font-size:28px;font-weight:900;margin:15px 0;}
.buy-btn, .add-btn{background:#7c4dff;color:#fff;border:none;padding:12px 20px;border-radius:10px;font-size:16px;cursor:pointer;margin-top:15px;}
.add-btn{background:#333;}
section h2{margin-top:40px;font-weight:800;font-size:24px;}
.related{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:18px;margin-top:20px;}
.card{background:#fff;border-radius:10px;padding:10px;box-shadow:0 4px 12px rgba(0,0,0,0.1);cursor:pointer;text-align:center;}
.card img{width:100%;background:#f6f6f6;border-radius:8px;}
.card .name{font-weight:600;margin-top:6px;}
.card .price{font-weight:900;margin-top:4px;}
.toast{position:fixed;bottom:-80px;left:50%;transform:translateX(-50%);background:#7c4dff;color:#fff;padding:14px 22px;border-radius:10px;transition:.4s;z-index:200;}
.toast.show{bottom:60px;opacity:1;}
.cart-btn-icon img{width:22px;cursor:pointer;}
.cart-panel{position:fixed;top:0;right:-400px;width:340px;height:100%;background:#fff;box-shadow:-4px 0 20px rgba(0,0,0,0.3);transition:.3s;padding:16px;z-index:100;}
.cart-panel.open{right:0;}
.cart-item{display:flex;justify-content:space-between;margin-bottom:12px;}
.cart-item button{background:none;border:none;color:#7c4dff;font-weight:bold;cursor:pointer;}
</style>
</head>

<body>

<header>
  <button id="loginBtn" class="login-btn" style="background:none;border:none;color:#7c4dff;font-weight:600;font-size:16px;cursor:pointer;">Iniciar Sesi√≥n</button>
  <div class="logo">Boutique Buend√≠a</div>

  <div id="cartBtn" class="cart-btn-icon">
    <img src="https://cdn-icons-png.flaticon.com/512/833/833314.png">
  </div>
</header>

<main>
  <div class="product-container" id="productContent"></div>

  <section>
    <h2>Tambi√©n te puede interesar</h2>
    <div class="related" id="relatedGrid"></div>
  </section>
</main>

<!-- Carrito -->
<div class="cart-panel" id="cartPanel">
  <h2>Carrito</h2>
  <div id="cartItems"></div>
  <p id="cartTotal" style="text-align:right;font-weight:bold;"></p>
</div>

<div class="toast" id="toast">Producto agregado</div>

<script>
let productos = JSON.parse(localStorage.getItem('productos')) || [];
let cart = JSON.parse(localStorage.getItem('cart')) || [];

const params = new URLSearchParams(window.location.search);
const productId = parseInt(params.get("id"));
const product = productos.find(p => p.id === productId);

const box = document.getElementById("productContent");
if(product){
  box.innerHTML = `
    <img src="${product.imagen}">
    <div class="product-info">
      <h1>${product.nombre}</h1>
      <div class="price">$${product.precio}</div>
      <p>${product.descripcion || "Sin descripci√≥n disponible."}</p>
      <button class="add-btn" onclick="agregar('${product.nombre}', ${product.precio})">Agregar al carrito</button>
      <button class="buy-btn" onclick="pagar(${product.precio})">Comprar ahora</button>
    </div>`;
}

function agregar(n, pr){
  cart.push({n, pr});
  localStorage.setItem('cart', JSON.stringify(cart));
  showToast();
  renderCart();
}

function pagar(precio){
  alert("Pago con PayPal pr√≥ximamente üü°");
}

function renderRelated(){
  const related = productos.filter(p=>p.id!==product.id && p.nombre.split(" ")[0] === product.nombre.split(" ")[0]).slice(0,4);
  const grid = document.getElementById("relatedGrid");
  grid.innerHTML = "";
  related.forEach(p=>{
    grid.innerHTML += `
    <div class="card" onclick="window.location='product.html?id=${p.id}'">
      <img src="${p.imagen}">
      <div class="name">${p.nombre}</div>
      <div class="price">$${p.precio}</div>
    </div>`;
  });
}
renderRelated();

function renderCart(){
  const c = document.getElementById("cartItems");
  c.innerHTML = "";
  let total=0;
  cart.forEach((p,i)=>{ total+=p.pr;
    c.innerHTML+=`<div class="cart-item">${p.n} - $${p.pr}<button onclick="removeItem(${i})">‚úï</button></div>`;
  });
  document.getElementById("cartTotal").textContent="Total: $"+total;
}
function removeItem(i){
  cart.splice(i,1);
  localStorage.setItem('cart',JSON.stringify(cart));
  renderCart();
}

function showToast(){
  const t=document.getElementById("toast");
  t.classList.add("show");
  setTimeout(()=>t.classList.remove("show"),2500);
}

document.getElementById("cartBtn").onclick = ()=> document.getElementById("cartPanel").classList.add("open");
document.getElementById("cartPanel").onclick = ()=> document.getElementById("cartPanel").classList.remove("open");

renderCart();
</script>

<!-- ‚úÖ Activar sesi√≥n global -->
<script src="js/header.js"></script>

</body>
</html>
