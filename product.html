<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Producto | Boutique Buend√≠a</title>

<style>
:root {
  --bg: #ffffff;
  --text: #111;
  --muted: #777;
  --card-bg: #fff;
  --accent: #7c4dff;
  --shadow: 0 8px 20px rgba(0,0,0,0.08);
}
body{margin:0;font-family:Inter,system-ui,sans-serif;background:var(--bg);color:var(--text);}
header{background:#fff;border-bottom:1px solid #ddd;padding:14px 20px;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:20;}
.logo{font-weight:900;font-size:22px;}
.login-btn{background:none;border:none;color:var(--accent);cursor:pointer;font-weight:600;}
.icon img{width:22px;cursor:pointer;}

main{max-width:1100px;margin:auto;padding:20px;}

.product-container{display:flex;flex-wrap:wrap;gap:30px;}
.product-img{flex:1;min-width:260px;}
.product-img img{width:100%;border-radius:10px;box-shadow:var(--shadow);}

.product-info{flex:1;min-width:260px;display:flex;flex-direction:column;gap:12px;}
.product-title{font-size:26px;font-weight:800;}
.product-price{font-size:22px;font-weight:700;margin-top:6px;}
.add-cart-btn{background:var(--accent);color:white;border:none;padding:12px;border-radius:8px;font-size:17px;font-weight:600;cursor:pointer;}
.add-cart-btn:hover{opacity:0.9;}

.related-title{margin-top:50px;font-size:22px;font-weight:700;}
.related-row{display:flex;overflow-x:auto;gap:14px;padding-bottom:10px;margin-top:16px;}
.related-card{min-width:160px;background:#fff;border-radius:8px;box-shadow:var(--shadow);cursor:pointer;}
.related-card img{width:100%;border-radius:8px 8px 0 0;background:#f3f3f3;height:150px;object-fit:contain;}
.related-card .name{font-size:14px;padding:8px;font-weight:600;}
.related-card .price{font-size:14px;padding:0 8px 12px;font-weight:700;color:var(--accent);}

.toast{position:fixed;bottom:-70px;left:50%;transform:translateX(-50%);background:var(--accent);color:#fff;padding:12px 18px;border-radius:8px;opacity:0;transition:.4s;z-index:200;}
.toast.show{bottom:60px;opacity:1;}
</style>
</head>

<body>

<header>
  <div class="logo">Boutique Buend√≠a</div>
  <div style="display:flex;align-items:center;gap:14px;">
    <button id="loginBtn" class="login-btn">Iniciar Sesi√≥n</button>
    <div id="cartBtn" class="icon"><img src="https://cdn-icons-png.flaticon.com/512/833/833314.png"></div>
  </div>
</header>

<main>
  <div class="product-container">
    <div class="product-img">
      <img id="prodImg">
    </div>

    <div class="product-info">
      <div class="product-title" id="prodName"></div>
      <div class="product-price" id="prodPrice"></div>
      <div id="prodDesc" style="color:var(--muted);font-size:14px;"></div>
      <button id="addCartBtn" class="add-cart-btn">Agregar al carrito</button>
    </div>
  </div>

  <div class="related-title">Tambi√©n te podr√≠a gustar</div>
  <div class="related-row" id="relatedRow"></div>
</main>

<div class="toast" id="toast">Agregado al carrito</div>

<script>
let productos = JSON.parse(localStorage.getItem("productos")) || [];
let cart = JSON.parse(localStorage.getItem("cart")) || [];

/* Detectar usuario para mostrar Bienvenida */
function actualizarHeader(){
  const usuario = JSON.parse(localStorage.getItem("usuario"));
  if(usuario){
    loginBtn.style.display="none";
    document.querySelector("header").insertAdjacentHTML("beforeend",
      `<span style="font-weight:600;color:var(--accent);margin-left:10px;">Bienvenido, ${usuario.nombre} üëã</span>`
    );
  }
}

/* Obtener ID desde URL */
const params = new URLSearchParams(window.location.search);
const id = Number(params.get("id"));
const prod = productos.find(p => p.id == id);

/* Si no existe producto ‚Üí regresar */
if(!prod){
  document.body.innerHTML = "<h2 style='text-align:center;margin-top:60px;'>Producto no encontrado</h2>";
}

/* Rellenar */
document.getElementById("prodImg").src = prod.imagen;
document.getElementById("prodName").innerText = prod.nombre;
document.getElementById("prodPrice").innerText = "$" + prod.precio.toLocaleString("es-MX");
document.getElementById("prodDesc").innerText = prod.descripcion;

/* Agregar al carrito */
document.getElementById("addCartBtn").onclick = () => {
  cart.push({ name: prod.nombre, price: prod.precio });
  localStorage.setItem("cart", JSON.stringify(cart));
  showToast();
};

/* Toast */
function showToast(){
  toast.classList.add("show");
  setTimeout(()=> toast.classList.remove("show"), 2000);
}

/* Relacionados */
let relacionados = productos.filter(p => p.id !== prod.id).slice(0,6);
const row = document.getElementById("relatedRow");

relacionados.forEach(r=>{
  row.innerHTML += `
    <div class="related-card" onclick="window.location='product.html?id=${r.id}'">
      <img src="${r.imagen}">
      <div class="name">${r.nombre}</div>
      <div class="price">$${r.precio.toLocaleString('es-MX')}</div>
    </div>
  `;
});

/* Bot√≥n carrito */
cartBtn.onclick = ()=> window.location="index.html#carrito";

/* Ejecutar bienvenida */
actualizarHeader();
</script>

</body>
</html>
